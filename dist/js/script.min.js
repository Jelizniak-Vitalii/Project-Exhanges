import getTime from"./getTime.js";const courseActual="https://api.privatbank.ua/p24api/pubinfo?exchange&json&coursid=11",courseAllCurrency="https://v6.exchangerate-api.com/v6/d5003c17d1570e4b59f84b4a/latest/";let arrayBuy=[],arraySale=[],arrayCurrency=[];async function getCourse(){try{let e=await fetch(courseActual);return getInfo((await e.json()).splice(0,3))}catch(e){console.log(e)}}function getInfo(e){let r=document.querySelectorAll(".currency-buy"),t=document.querySelectorAll(".currency-sale");e.forEach(e=>{arrayCurrency.push(e.ccy),arrayBuy.push(e.buy),arraySale.push(e.sale),addNameCurrency(arrayCurrency),showCurrency(arrayBuy,r),showCurrency(arraySale,t)})}function addNameCurrency(e){let r=document.querySelectorAll(".rates-currency__title");for(let t=0;t<e.length;t++)"RUR"===e[t]&&(e[t]="RUB"),r[t].textContent=e[t]+"/UAH"}function showCurrency(e,r){for(let t=0;t<e.length;t++){let c=parseFloat(e[t]).toFixed(2);r[t].textContent=c}}window.onload=()=>{getCourse(),getValueCurrency()},setInterval((function(){document.querySelector(".header-time__actual").innerHTML=getTime()}),100);let firstSelect=document.querySelector(".currency-base__select"),secondSelect=document.querySelector(".currency-to-change__select"),firstCurrencyInput=document.querySelector(".currency-base__input"),secondCurrencyInput=document.querySelector(".currency-to-change__input");async function getValueCurrency(e="EUR"){try{let r=await fetch(`${courseAllCurrency}${e}`),t=await r.json();console.log(t.conversion_rates),addCurrencyValue(t.conversion_rates,firstSelect),addCurrencyValue(t.conversion_rates,secondSelect)}catch(e){console.log(e)}}let a=document.createElement("input"),b=document.createElement("input");function addCurrencyValue(e,r){for(let c in e){var t=document.createElement("option");t.textContent=c,t.value=c,r.append(t)}watchChange(e,firstSelect,a),watchChange(e,secondSelect,b)}function watchChange(e,r,t){r.addEventListener("change",()=>{for(let[c,n]of Object.entries(e))c===r.value&&(t.value=n)})}document.querySelector(".converter-button").addEventListener("click",()=>{if(a.value.length>0&&b.value.length>0)if(firstCurrencyInput.value<1)console.log("Ведите сумум для обмена"),firstCurrencyInput.className="error",firstSelect.className="first-currency__select",secondSelect.className="second-currency__select";else if(firstCurrencyInput.className="first-currency__input",console.log(a.value),a.value>b.value){let e=a.value/b.value,r=firstCurrencyInput.value/e;secondCurrencyInput.value=r.toFixed(2)}else{let e=b.value/a.value,r=firstCurrencyInput.value*(Math.floor(100*e)/100);secondCurrencyInput.value=r}else console.log("Выберите валюту"),firstSelect.className="error",secondSelect.className="error"});